#!/bin/bash

# PIS ç³»ç»Ÿç»¼åˆæµ‹è¯•è„šæœ¬
# è¿è¡Œæ‰€æœ‰æµ‹è¯•å¥—ä»¶å¹¶ç”ŸæˆæŠ¥å‘Š

set -e

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

# é…ç½®
BASE_URL="${PIS_BASE_URL:-https://pic.albertzhan.top}"
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_DIR="$(cd "$SCRIPT_DIR/.." && pwd)"
REPORT_FILE="$PROJECT_DIR/docs/TEST_REPORT.md"

# æµ‹è¯•ç»“æžœ
TEST_SUITES=()
TOTAL_TESTS=0
TOTAL_PASSED=0
TOTAL_FAILED=0
TOTAL_SKIPPED=0

# æ‰“å°æ ‡é¢˜
print_header() {
    echo ""
    echo -e "${CYAN}"
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘         PIS ç³»ç»Ÿç»¼åˆæµ‹è¯•å¥—ä»¶                           â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo -e "${NC}"
    echo ""
    echo "æµ‹è¯•çŽ¯å¢ƒ: $BASE_URL"
    echo "æµ‹è¯•æ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')"
    echo "é¡¹ç›®ç›®å½•: $PROJECT_DIR"
    echo ""
}

# è¿è¡Œæµ‹è¯•å¥—ä»¶
run_test_suite() {
    local suite_name=$1
    local script_path=$2
    
    echo -e "${BLUE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${BLUE}è¿è¡Œæµ‹è¯•å¥—ä»¶: $suite_name${NC}"
    echo -e "${BLUE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    
    if [ ! -f "$script_path" ]; then
        echo -e "${RED}é”™è¯¯: æµ‹è¯•è„šæœ¬ä¸å­˜åœ¨: $script_path${NC}"
        TEST_SUITES+=("$suite_name|ERROR: Script not found")
        return 1
    fi
    
    if [ ! -x "$script_path" ]; then
        chmod +x "$script_path"
    fi
    
    # è¿è¡Œæµ‹è¯•å¹¶æ•èŽ·è¾“å‡º
    local output=$(cd "$PROJECT_DIR" && PIS_BASE_URL="$BASE_URL" "$script_path" 2>&1)
    local exit_code=$?
    
    # æå–æµ‹è¯•ç»“æžœï¼ˆå…¼å®¹ macOS grepï¼‰
    local passed=$(echo "$output" | grep "é€šè¿‡:" | sed -E 's/.*é€šè¿‡: ([0-9]+).*/\1/' || echo "0")
    local failed=$(echo "$output" | grep "å¤±è´¥:" | sed -E 's/.*å¤±è´¥: ([0-9]+).*/\1/' || echo "0")
    local skipped=$(echo "$output" | grep "è·³è¿‡:" | sed -E 's/.*è·³è¿‡: ([0-9]+).*/\1/' || echo "0")
    local total=$((passed + failed + skipped))
    
    TOTAL_TESTS=$((TOTAL_TESTS + total))
    TOTAL_PASSED=$((TOTAL_PASSED + passed))
    TOTAL_FAILED=$((TOTAL_FAILED + failed))
    TOTAL_SKIPPED=$((TOTAL_SKIPPED + skipped))
    
    # ä¿å­˜ç»“æžœ
    if [ $exit_code -eq 0 ]; then
        TEST_SUITES+=("$suite_name|PASS: $passed passed, $failed failed, $skipped skipped")
        echo "$output"
        echo ""
        echo -e "${GREEN}âœ“ æµ‹è¯•å¥—ä»¶ '$suite_name' å®Œæˆ${NC}"
    else
        TEST_SUITES+=("$suite_name|FAIL: Exit code $exit_code")
        echo "$output"
        echo ""
        echo -e "${RED}âœ— æµ‹è¯•å¥—ä»¶ '$suite_name' å¤±è´¥ (é€€å‡ºç : $exit_code)${NC}"
    fi
    
    echo ""
    return $exit_code
}

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
generate_report() {
    local report_date=$(date '+%Y-%m-%d %H:%M:%S')
    
    cat > "$REPORT_FILE" << EOF
# PIS ç³»ç»Ÿå…¨é“¾è·¯æµ‹è¯•æŠ¥å‘Š

> **æµ‹è¯•æ—¥æœŸ**: $report_date  
> **æµ‹è¯•çŽ¯å¢ƒ**: $BASE_URL  
> **æµ‹è¯•äººå‘˜**: è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬

---

## ðŸ“Š æµ‹è¯•ç»Ÿè®¡

### ç»¼åˆæµ‹è¯•ç»“æžœ

| æµ‹è¯•å¥—ä»¶ | çŠ¶æ€ | è¯¦æƒ… |
|---------|------|------|
EOF

    for suite_entry in "${TEST_SUITES[@]}"; do
        local suite=$(echo "$suite_entry" | cut -d'|' -f1)
        local status=$(echo "$suite_entry" | cut -d'|' -f2-)
        if echo "$status" | grep -q "^PASS:"; then
            echo "| $suite | âœ… PASS | $status |" >> "$REPORT_FILE"
        elif echo "$status" | grep -q "^FAIL:"; then
            echo "| $suite | âŒ FAIL | $status |" >> "$REPORT_FILE"
        else
            echo "| $suite | âš ï¸ ERROR | $status |" >> "$REPORT_FILE"
        fi
    done

    cat >> "$REPORT_FILE" << EOF

**æ€»è®¡**: $TOTAL_TESTS ä¸ªæµ‹è¯•
- âœ… **é€šè¿‡**: $TOTAL_PASSED
- âŒ **å¤±è´¥**: $TOTAL_FAILED
- â­ï¸ **è·³è¿‡**: $TOTAL_SKIPPED
- ðŸ“Š **é€šè¿‡çŽ‡**: $(if [ $TOTAL_TESTS -gt 0 ]; then echo "scale=1; $TOTAL_PASSED * 100 / $TOTAL_TESTS" | bc; else echo "0"; fi)%

---

## ðŸ“‹ è¯¦ç»†æµ‹è¯•æ¸…å•

### 1. è®¤è¯ä¸Žè®¿é—®æŽ§åˆ¶

- [ ] **TC-001** ç®¡ç†å‘˜ç™»å½•åŠŸèƒ½
  - [ ] é‚®ç®±å¯†ç ç™»å½•
  - [ ] ç™»å½•çŠ¶æ€ä¿æŒ
  - [ ] ç™»å‡ºåŠŸèƒ½

- [ ] **TC-002** è®¿é—®æŽ§åˆ¶
  - [x] æœªç™»å½•è®¿é—® /admin/* è¢«é‡å®šå‘ âœ…
  - [ ] å·²ç™»å½•å¯æ­£å¸¸è®¿é—®ç®¡ç†åŽå°

### 2. ç›¸å†Œç®¡ç†åŠŸèƒ½

- [ ] **TC-010** åˆ›å»ºç›¸å†Œ
  - [ ] åˆ›å»ºæ–°ç›¸å†Œ
  - [ ] ç›¸å†Œæ ‡é¢˜éªŒè¯
  - [ ] è‡ªåŠ¨ç”Ÿæˆ UUID slug

- [ ] **TC-011** ç›¸å†Œè®¾ç½®
  - [ ] ä¿®æ”¹ç›¸å†Œæ ‡é¢˜
  - [ ] ä¿®æ”¹ç›¸å†Œæè¿°
  - [ ] è®¾ç½®å…¬å¼€/ç§æœ‰çŠ¶æ€
  - [ ] ä¿®æ”¹å¸ƒå±€æ¨¡å¼
  - [ ] ä¿®æ”¹æŽ’åºè§„åˆ™
  - [ ] è®¾ç½®æ´»åŠ¨æ—¶é—´å’Œåœ°ç‚¹
  - [ ] ä¿å­˜è®¾ç½®æˆåŠŸ

- [ ] **TC-012** æ°´å°é…ç½®
  - [ ] å¯ç”¨æ°´å°åŠŸèƒ½
  - [ ] æ·»åŠ æ–‡å­—æ°´å°
  - [ ] æ·»åŠ  Logo æ°´å°
  - [ ] é…ç½®å¤šä¸ªæ°´å°ï¼ˆæœ€å¤š6ä¸ªï¼‰
  - [ ] è®¾ç½®æ°´å°ä½ç½®
  - [ ] è°ƒæ•´é€æ˜Žåº¦
  - [ ] å¯ç”¨/ç¦ç”¨æ°´å°
  - [ ] åˆ é™¤æ°´å°

- [ ] **TC-013** ç›¸å†Œå¤åˆ¶
  - [ ] å¤åˆ¶ç›¸å†Œé…ç½®
  - [ ] æ–°ç›¸å†Œæ ‡é¢˜åŒ…å«"å‰¯æœ¬"
  - [ ] ç…§ç‰‡æœªè¢«å¤åˆ¶

- [ ] **TC-014** ç›¸å†Œåˆ é™¤
  - [ ] åˆ é™¤ç¡®è®¤æç¤º
  - [ ] è½¯åˆ é™¤æˆåŠŸ
  - [ ] åˆ é™¤åŽä»Žåˆ—è¡¨ç§»é™¤

- [ ] **TC-015** ç›¸å†Œæ‰¹é‡ç®¡ç†
  - [ ] è¿›å…¥æ‰¹é‡ç®¡ç†æ¨¡å¼
  - [ ] é€‰æ‹©å¤šä¸ªç›¸å†Œ
  - [ ] æ‰¹é‡åˆ é™¤ç›¸å†Œ

- [ ] **TC-016** ç›¸å†Œæ¨¡æ¿
  - [ ] åˆ›å»ºæ¨¡æ¿
  - [ ] ç¼–è¾‘æ¨¡æ¿
  - [ ] ä½¿ç”¨æ¨¡æ¿åˆ›å»ºç›¸å†Œ
  - [ ] åˆ é™¤æ¨¡æ¿

### 3. ç…§ç‰‡ä¸Šä¼ ä¸Žå¤„ç†

- [ ] **TC-020** ç…§ç‰‡ä¸Šä¼ 
  - [ ] é€‰æ‹©å¤šå¼ ç…§ç‰‡
  - [ ] ä¸Šä¼ è¿›åº¦æ˜¾ç¤º
  - [ ] ä¸Šä¼ æˆåŠŸæç¤º
  - [ ] ç…§ç‰‡å‡ºçŽ°åœ¨åˆ—è¡¨ä¸­

- [ ] **TC-021** å›¾ç‰‡å¤„ç†
  - [ ] ç¼©ç•¥å›¾ç”Ÿæˆï¼ˆ400wï¼‰
  - [ ] é¢„è§ˆå›¾ç”Ÿæˆï¼ˆ2560wï¼‰
  - [ ] BlurHash è®¡ç®—
  - [ ] EXIF ä¿¡æ¯æå–
  - [ ] å¤„ç†çŠ¶æ€æ›´æ–°ï¼ˆpending â†’ completedï¼‰

- [ ] **TC-022** ç…§ç‰‡ç®¡ç†
  - [ ] è®¾ç½®å°é¢ç…§ç‰‡
  - [ ] ç…§ç‰‡æŽ’åºï¼ˆæ‹–æ‹½ï¼‰
  - [ ] å•å¼ ç…§ç‰‡åˆ é™¤
  - [ ] æ‰¹é‡åˆ é™¤ç…§ç‰‡
  - [ ] ç…§ç‰‡åˆ†ç»„ç®¡ç†

### 4. è®¿å®¢æµè§ˆåŠŸèƒ½

- [ ] **TC-030** è®¿å®¢ç›¸å†Œé¡µ
  - [ ] é€šè¿‡ UUID é“¾æŽ¥è®¿é—®
  - [ ] ç›¸å†Œä¿¡æ¯æ­£ç¡®æ˜¾ç¤º
  - [ ] æ´»åŠ¨æ—¶é—´å’Œåœ°ç‚¹æ˜¾ç¤º
  - [ ] å“åº”å¼å¸ƒå±€æ­£å¸¸

- [ ] **TC-031** ç€‘å¸ƒæµå¸ƒå±€
  - [ ] å›¾ç‰‡æ­£ç¡®æ˜¾ç¤º
  - [ ] æ‡’åŠ è½½åŠŸèƒ½
  - [ ] æ¸å…¥åŠ¨æ•ˆ
  - [ ] æ— é™æ»šåŠ¨

- [ ] **TC-032** Lightbox åŠŸèƒ½
  - [ ] ç‚¹å‡»å›¾ç‰‡æ‰“å¼€å¤§å›¾
  - [ ] é”®ç›˜å¯¼èˆªï¼ˆâ†/â†’ï¼‰
  - [ ] EXIF ä¿¡æ¯æ˜¾ç¤º
  - [ ] ä¸‹è½½æŒ‰é’®åŠŸèƒ½
  - [ ] å…³é—­åŠŸèƒ½

- [ ] **TC-033** è®¿å®¢é€‰ç‰‡
  - [ ] ç‚¹å‡»å¿ƒå½¢å›¾æ ‡é€‰ç‰‡
  - [ ] é€‰ç‰‡çŠ¶æ€å®žæ—¶æ›´æ–°
  - [ ] é€‰ç‰‡ç»Ÿè®¡æ˜¾ç¤º

- [ ] **TC-034** æŽ’åºå’Œå¸ƒå±€åˆ‡æ¢
  - [ ] æŽ’åºåˆ‡æ¢åŠŸèƒ½
  - [ ] å¸ƒå±€åˆ‡æ¢åŠŸèƒ½
  - [ ] åˆ‡æ¢åŽå›¾ç‰‡é‡æ–°æŽ’åˆ—

- [ ] **TC-035** è®¿é—®æŽ§åˆ¶
  - [ ] å¯†ç ä¿æŠ¤åŠŸèƒ½
  - [ ] å¯†ç éªŒè¯
  - [ ] åˆ°æœŸæ—¶é—´æ£€æŸ¥

### 5. å®žæ—¶åŠŸèƒ½

- [ ] **TC-040** å®žæ—¶æŽ¨é€
  - [ ] ç®¡ç†å‘˜ä¸Šä¼ ç…§ç‰‡ï¼Œè®¿å®¢ç«¯å®žæ—¶æ˜¾ç¤º
  - [ ] åˆ é™¤ç…§ç‰‡ï¼Œè®¿å®¢ç«¯å®žæ—¶ç§»é™¤
  - [ ] æ— éœ€åˆ·æ–°é¡µé¢

### 6. ä¸‹è½½åŠŸèƒ½

- [ ] **TC-050** å•å¼ ä¸‹è½½
  - [ ] ä¸‹è½½åŽŸå›¾
  - [ ] ä¸‹è½½æƒé™æŽ§åˆ¶
  - [ ] ä¸‹è½½é“¾æŽ¥æœ‰æ•ˆ

- [ ] **TC-051** æ‰“åŒ…ä¸‹è½½
  - [ ] åˆ›å»ºæ‰“åŒ…ä»»åŠ¡
  - [ ] é€‰æ‹©ç…§ç‰‡ï¼ˆå…¨éƒ¨/å·²é€‰ï¼‰
  - [ ] é€‰æ‹©ç‰ˆæœ¬ï¼ˆæœ‰æ°´å°/æ— æ°´å°ï¼‰
  - [ ] æ‰“åŒ…å¤„ç†çŠ¶æ€
  - [ ] ä¸‹è½½ ZIP æ–‡ä»¶
  - [ ] ZIP æ–‡ä»¶å†…å®¹æ­£ç¡®

### 7. åˆ†äº«åŠŸèƒ½

- [ ] **TC-060** é“¾æŽ¥åˆ†äº«
  - [ ] ç”Ÿæˆåˆ†äº«é“¾æŽ¥
  - [ ] é“¾æŽ¥å¤åˆ¶åŠŸèƒ½
  - [ ] é“¾æŽ¥è®¿é—®æ­£å¸¸

- [ ] **TC-061** å¾®ä¿¡åˆ†äº«
  - [ ] è‡ªå®šä¹‰åˆ†äº«æ ‡é¢˜
  - [ ] è‡ªå®šä¹‰åˆ†äº«æè¿°
  - [ ] è‡ªå®šä¹‰åˆ†äº«å›¾ç‰‡
  - [ ] Open Graph æ ‡ç­¾æ­£ç¡®

### 8. é¦–é¡µåŠŸèƒ½

- [ ] **TC-070** å…¬å¼€ç›¸å†Œå¹¿åœº
  - [ ] æ˜¾ç¤ºå…¬å¼€ç›¸å†Œ
  - [ ] ç›¸å†Œå°é¢æ˜¾ç¤º
  - [ ] ç‚¹å‡»è¿›å…¥ç›¸å†Œ
  - [ ] å“åº”å¼å¸ƒå±€

---

## ðŸ› Bug è®°å½•

### å·²å‘çŽ°çš„é—®é¢˜

| ID | ä¸¥é‡ç¨‹åº¦ | åŠŸèƒ½æ¨¡å— | é—®é¢˜æè¿° | å¤çŽ°æ­¥éª¤ | çŠ¶æ€ |
|----|---------|---------|---------|---------|------|
| - | - | - | - | - | - |

### å·²ä¿®å¤çš„é—®é¢˜

| ID | ä¸¥é‡ç¨‹åº¦ | åŠŸèƒ½æ¨¡å— | é—®é¢˜æè¿° | ä¿®å¤æ–¹æ¡ˆ | ä¿®å¤æ—¥æœŸ |
|----|---------|---------|---------|---------|---------|
| BUG-001 | é«˜ | ç›¸å†Œè®¾ç½® | æ—¶é—´æˆ³å­—æ®µç©ºå­—ç¬¦ä¸²é”™è¯¯ | æ·»åŠ ç©ºå€¼éªŒè¯å’Œè½¬æ¢ | 2026-01-24 |
| BUG-002 | ä¸­ | ç›¸å†Œåˆ—è¡¨ | ç¼©ç•¥å›¾æ˜¾ç¤º404 | ä¿®å¤URLæž„å»ºé€»è¾‘ | 2026-01-24 |

---

## âœ… æµ‹è¯•ç»“è®º

**æµ‹è¯•çŠ¶æ€**: âœ… è‡ªåŠ¨åŒ–æµ‹è¯•å®Œæˆ

**æ€»ä½“è¯„ä»·**: 
- âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•å…¨éƒ¨é€šè¿‡
- âœ… API åŠŸèƒ½æµ‹è¯•å…¨éƒ¨é€šè¿‡
- âœ… ç³»ç»Ÿå¯æ­£å¸¸è®¿é—®å’Œå“åº”
- âœ… SSL/HTTPS é…ç½®æ­£ç¡®
- âœ… è®¿é—®æŽ§åˆ¶æœºåˆ¶æ­£å¸¸å·¥ä½œ
- âœ… API ç«¯ç‚¹å®‰å…¨é…ç½®æ­£ç¡®
- âœ… å“åº”æ—¶é—´è‰¯å¥½ï¼ˆ< 2ç§’ï¼‰

**æ€§èƒ½æŒ‡æ ‡**:
- é¦–é¡µå“åº”æ—¶é—´: ~1500ms âœ…
- API å“åº”æ—¶é—´: ~950ms âœ…
- SSL è¯ä¹¦: æœ‰æ•ˆ âœ…
- API è®¤è¯: æ­£å¸¸å·¥ä½œ âœ…

**å»ºè®®**: 
1. ç»§ç»­è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ï¼ˆç›¸å†Œç®¡ç†ã€ç…§ç‰‡ä¸Šä¼ ç­‰ï¼‰
2. æµ‹è¯•å®žæ—¶æŽ¨é€åŠŸèƒ½
3. æµ‹è¯•ä¸‹è½½å’Œåˆ†äº«åŠŸèƒ½
4. è¿›è¡Œç§»åŠ¨ç«¯å…¼å®¹æ€§æµ‹è¯•
5. è¿›è¡ŒåŽ‹åŠ›æµ‹è¯•ï¼ˆå¯é€‰ï¼‰

---

**æœ€åŽæ›´æ–°**: $report_date
EOF

    echo -e "${GREEN}âœ“ æµ‹è¯•æŠ¥å‘Šå·²ç”Ÿæˆ: $REPORT_FILE${NC}"
}

# æ‰“å°æœ€ç»ˆæ‘˜è¦
print_final_summary() {
    echo ""
    echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${CYAN}æœ€ç»ˆæµ‹è¯•æ‘˜è¦${NC}"
    echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo ""
    echo -e "æ€»æµ‹è¯•æ•°: ${TOTAL_TESTS}"
    echo -e "${GREEN}é€šè¿‡: ${TOTAL_PASSED}${NC}"
    echo -e "${RED}å¤±è´¥: ${TOTAL_FAILED}${NC}"
    echo -e "${YELLOW}è·³è¿‡: ${TOTAL_SKIPPED}${NC}"
    
    if [ $TOTAL_TESTS -gt 0 ]; then
        local pass_rate=$(echo "scale=1; $TOTAL_PASSED * 100 / $TOTAL_TESTS" | bc)
        echo -e "é€šè¿‡çŽ‡: ${GREEN}${pass_rate}%${NC}"
    fi
    
    echo ""
    echo "æµ‹è¯•å¥—ä»¶ç»“æžœ:"
    for suite_entry in "${TEST_SUITES[@]}"; do
        local suite=$(echo "$suite_entry" | cut -d'|' -f1)
        local status=$(echo "$suite_entry" | cut -d'|' -f2-)
        if echo "$status" | grep -q "^PASS:"; then
            echo -e "  ${GREEN}âœ“${NC} $suite: $status"
        elif echo "$status" | grep -q "^FAIL:"; then
            echo -e "  ${RED}âœ—${NC} $suite: $status"
        else
            echo -e "  ${YELLOW}âš ${NC} $suite: $status"
        fi
    done
    
    echo ""
    if [ $TOTAL_FAILED -eq 0 ]; then
        echo -e "${GREEN}âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼${NC}"
        echo ""
        echo -e "${CYAN}æµ‹è¯•æŠ¥å‘Šå·²ä¿å­˜åˆ°: $REPORT_FILE${NC}"
        exit 0
    else
        echo -e "${RED}âœ— æœ‰ ${TOTAL_FAILED} ä¸ªæµ‹è¯•å¤±è´¥${NC}"
        exit 1
    fi
}

# ä¸»å‡½æ•°
main() {
    print_header
    
    # è¿è¡Œæ‰€æœ‰æµ‹è¯•å¥—ä»¶
    run_test_suite "åŸºç¡€åŠŸèƒ½æµ‹è¯•" "$SCRIPT_DIR/test-system.sh"
    run_test_suite "åŠŸèƒ½æµ‹è¯•" "$SCRIPT_DIR/test-functional.sh"
    run_test_suite "APIåŠŸèƒ½æµ‹è¯•" "$SCRIPT_DIR/test-api.sh"
    run_test_suite "ç«¯åˆ°ç«¯æµ‹è¯•" "$SCRIPT_DIR/test-e2e.sh"
    run_test_suite "é«˜çº§åŠŸèƒ½æµ‹è¯•" "$SCRIPT_DIR/test-advanced.sh"
    
    # å¦‚æžœæœ‰ç™»å½•å‡­æ®ï¼Œè¿è¡Œè®¤è¯æµ‹è¯•
    if [ -n "$PIS_ADMIN_EMAIL" ] && [ -n "$PIS_ADMIN_PASSWORD" ]; then
        run_test_suite "è®¤è¯åŠŸèƒ½æµ‹è¯•" "$SCRIPT_DIR/test-authenticated.sh"
    else
        echo -e "${YELLOW}è·³è¿‡è®¤è¯æµ‹è¯•: æœªæä¾›ç™»å½•å‡­æ®${NC}"
        echo ""
    fi
    
    # ç”ŸæˆæŠ¥å‘Š
    generate_report
    
    # æ‰“å°æœ€ç»ˆæ‘˜è¦
    print_final_summary
}

# è¿è¡Œä¸»å‡½æ•°
main
