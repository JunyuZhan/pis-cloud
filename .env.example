# ============================================
# PIS 统一环境配置
# ============================================
#
# 使用说明:
# 1. 复制此文件为 .env (本地开发使用)
# 2. 部署脚本会自动生成标记为 AUTO_GENERATE 的密钥
# 3. 生产部署时，通过平台环境变量注入
#
# 密钥占位符说明:
# - AUTO_GENERATE: 自动生成随机密钥
# - AUTO_GENERATE_16: 自动生成 16 字符密钥
# - AUTO_GENERATE_32: 自动生成 32 字符密钥
#
# ===========================================

# ==================== 数据库配置 ====================
# 支持: supabase (推荐), postgresql, mysql
DATABASE_TYPE=supabase

# Supabase 配置 (当 DATABASE_TYPE=supabase 时使用)
# 获取方式: Supabase Dashboard -> Project Settings -> API
# [Vercel] 前端访问 Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
# [Vercel] 服务端 API Routes 使用（敏感信息，不要设置为 NEXT_PUBLIC_*）
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
# [Worker] Worker 服务使用的别名 (兼容，可与 NEXT_PUBLIC_SUPABASE_URL 相同)
SUPABASE_URL=https://your-project.supabase.co

# PostgreSQL/MySQL 配置 (当 DATABASE_TYPE=postgresql 或 mysql 时使用)
# DATABASE_URL=postgresql://user:password@host:5432/database
# DATABASE_HOST=localhost
# DATABASE_PORT=5432
# DATABASE_NAME=pis
# DATABASE_USER=postgres
# DATABASE_PASSWORD=AUTO_GENERATE
# DATABASE_SSL=false

# ==================== 存储配置 ====================
# 支持: minio (默认), oss (阿里云), cos (腾讯云), s3 (AWS)
STORAGE_TYPE=minio

# MinIO 配置 (当 STORAGE_TYPE=minio 时使用)
# 注意: NEXT_PUBLIC_MEDIA_URL 用于前端访问，STORAGE_ENDPOINT 用于后端连接
# 必须包含 bucket 路径（如 /pis-photos），用于构建完整的图片 URL
# [Vercel] 前端访问媒体服务器 URL
NEXT_PUBLIC_MEDIA_URL=https://media.yourdomain.com/pis-photos
# [Worker] Worker 服务连接存储后端（敏感信息，不要设置为 NEXT_PUBLIC_*）
STORAGE_ENDPOINT=localhost
STORAGE_PORT=9000
STORAGE_USE_SSL=false
STORAGE_ACCESS_KEY=AUTO_GENERATE_16
STORAGE_SECRET_KEY=AUTO_GENERATE
STORAGE_BUCKET=pis-photos
# 存储公网 URL（用于 Worker 清除 Cloudflare 缓存）
STORAGE_PUBLIC_URL=https://media.yourdomain.com

# 公网上传地址 (用于生成 presigned URL，绕过 Vercel 大小限制)
# [Worker] Worker 服务生成 presigned URL 使用
MINIO_PUBLIC_URL=https://media.yourdomain.com

# 兼容旧配置 (向后兼容，可省略)
MINIO_ENDPOINT_HOST=localhost
MINIO_ENDPOINT_PORT=9000
MINIO_USE_SSL=false
MINIO_ACCESS_KEY=${STORAGE_ACCESS_KEY}
MINIO_SECRET_KEY=${STORAGE_SECRET_KEY}
MINIO_BUCKET=${STORAGE_BUCKET}

# 阿里云 OSS 配置 (当 STORAGE_TYPE=oss 时使用)
# STORAGE_ENDPOINT=oss-cn-hangzhou.aliyuncs.com
# STORAGE_REGION=cn-hangzhou
# STORAGE_ACCESS_KEY=your-access-key-id
# STORAGE_SECRET_KEY=your-access-key-secret
# STORAGE_BUCKET=your-bucket-name
# STORAGE_PUBLIC_URL=https://your-bucket-name.oss-cn-hangzhou.aliyuncs.com

# 腾讯云 COS 配置 (当 STORAGE_TYPE=cos 时使用)
# STORAGE_ENDPOINT=cos.ap-guangzhou.myqcloud.com
# STORAGE_REGION=ap-guangzhou
# STORAGE_ACCESS_KEY=your-secret-id
# STORAGE_SECRET_KEY=your-secret-key
# STORAGE_BUCKET=your-bucket-name
# STORAGE_PUBLIC_URL=https://your-bucket-name.cos.ap-guangzhou.myqcloud.com

# AWS S3 配置 (当 STORAGE_TYPE=s3 时使用)
# STORAGE_ENDPOINT=s3.amazonaws.com
# STORAGE_REGION=us-east-1
# STORAGE_ACCESS_KEY=your-access-key-id
# STORAGE_SECRET_KEY=your-access-access-key
# STORAGE_BUCKET=your-bucket-name
# STORAGE_PUBLIC_URL=https://your-bucket-name.s3.amazonaws.com

# ==================== Worker 服务 ====================
# Worker 服务 URL (用于分片上传、图片处理等功能)
# [Vercel] 前端调用 Worker API 的 URL
NEXT_PUBLIC_WORKER_URL=http://localhost:3001
# [Worker] Worker 服务自身监听的 URL（可选，主要用于日志）
WORKER_URL=http://localhost:3001

# Worker API Key (用于 Worker API 认证，必须配置)
# 生成方式: AUTO_GENERATE_32 表示自动生成 32 字符随机密钥
# [Both] Vercel 和 Worker 服务都需要配置相同的值
WORKER_API_KEY=AUTO_GENERATE_32

# 图片处理标准配置（可选，默认值向后兼容）
# 预览图最大尺寸（像素），默认 1920px
# PREVIEW_MAX_SIZE=1920
# 缩略图最大尺寸（像素），默认 400px
# THUMB_MAX_SIZE=250

# ==================== Redis ====================
# Redis 配置（用于 Worker 队列和速率限制）
# 本地开发使用本地 Redis
# [Worker] Worker 服务连接 Redis（用于队列和缓存）
REDIS_HOST=localhost
REDIS_PORT=6379
# [Worker] Redis 密码（如果设置了）
# REDIS_PASSWORD=AUTO_GENERATE

# Upstash Redis 配置（可选，用于生产环境分布式速率限制）
# 获取方式: https://console.upstash.com/ -> Create Database
# [Vercel] Vercel 服务端 API Routes 使用（用于速率限制）
# UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
# UPSTASH_REDIS_REST_TOKEN=your-redis-token

# ==================== 应用配置 ====================
# [Vercel] 应用访问地址（生产域名，用于生成分享链接等）
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Photographer/Studio Branding
# [Vercel] 前端显示的品牌信息
NEXT_PUBLIC_PHOTOGRAPHER_NAME=PIS Photography
NEXT_PUBLIC_PHOTOGRAPHER_TAGLINE=专业活动摄影
# 自定义 Logo URL (可选，默认使用 /icons/icon.svg)
# NEXT_PUBLIC_LOGO_URL=/icons/your-logo.svg

# 背景图片配置 (可选)
# [Vercel] 首页背景图片API提供商，支持: picsum (默认), unsplash
NEXT_PUBLIC_BACKGROUND_IMAGE_PROVIDER=picsum

# ==================== Cloudflare Turnstile (可选) ====================
# 用于登录页面的机器人验证（Invisible 模式，用户无感知）
# 获取方式: https://dash.cloudflare.com/ -> Turnstile -> Add Site
# [Vercel] 前端使用站点密钥
# NEXT_PUBLIC_TURNSTILE_SITE_KEY=your-site-key
# [Vercel] 服务端验证使用密钥（敏感信息，不要设置为 NEXT_PUBLIC_*）
# TURNSTILE_SECRET_KEY=your-secret-key

# ==================== Cloudflare CDN 缓存清除 (可选) ====================
# 用于在删除照片时清除 CDN 缓存，确保删除后无法通过 CDN 访问
# [Vercel] Cloudflare API Token（敏感信息，不要设置为 NEXT_PUBLIC_*）
# CLOUDFLARE_API_TOKEN=your-api-token
# [Vercel] Cloudflare Zone ID
# CLOUDFLARE_ZONE_ID=your-zone-id
# [Vercel] 媒体服务器域名（可选，用于验证）
# CLOUDFLARE_MEDIA_DOMAIN=media.yourdomain.com

# ==================== 告警服务 (可选) ====================
# 用于 Worker 服务异常、照片处理失败等通知
# 支持通知渠道: telegram, email, log (默认)
# [Worker] Worker 服务中配置

# 告警开关（默认启用）
ALERT_ENABLED=true

# 告警类型（log|telegram|email）
ALERT_TYPE=log

# Telegram 配置（当 ALERT_TYPE=telegram 时使用）
# 获取方式: https://t.me/BotFather -> /newbot -> 获取 token
# Chat ID 获取: 发送消息给 @userinfobot，或访问 https://api.telegram.org/bot<token>/getUpdates
# TELEGRAM_BOT_TOKEN=your-bot-token
# TELEGRAM_CHAT_ID=your-chat-id

# 邮件配置（当 ALERT_TYPE=email 时使用）
# ALERT_SMTP_HOST=smtp.gmail.com
# ALERT_SMTP_PORT=587
# ALERT_SMTP_USER=your-email@gmail.com
# ALERT_SMTP_PASS=your-app-password
# ALERT_FROM_EMAIL=noreply@example.com
# ALERT_TO_EMAIL=admin@example.com

# ==================== 相册会话 (生产环境必须) ====================
# 用于相册密码验证后的会话管理（JWT Token）
# 重要: 生产环境必须设置，且至少 32 字符
# 生成方式: AUTO_GENERATE_32 表示自动生成
# [Vercel] Vercel 服务端需要配置（敏感信息，不要设置为 NEXT_PUBLIC_*）
ALBUM_SESSION_SECRET=AUTO_GENERATE_32
